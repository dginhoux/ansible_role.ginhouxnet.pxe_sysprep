---

pxe_sysprep_configure_action: generate
# pxe_sysprep_configure_action: cleanup

pxe_sysprep_root_folder: /srv/tftp


pxe_sysprep_generate_servers_list:
  - name: srv-swarm-manager1.infra.ginhoux.net
    state: present
    # os: Fedora.37
    # partitionning: nolvm-single
    # filesystem: ext4
    # filesystem_boot: ext2
    vgname: vg0
    disk: sda
    domain: infra.ginhoux.net
    rootpwd: root
    locale: en_US.UTF-8
    kblayout: fr
    timezone: Europe/Paris
    os_images_list:
      - name: Fedora.37
        state: present
        platforms:
          - name: bios
            state: present
            partitionings:
              - nolvm-single
              - lvm-multi1
              - lvm-multi2
          - name: efi64
            state: present
            partitionings:
              - nolvm-single
              - lvm-multi1
              - lvm-multi2
      - name: Fedora.38
        state: present
        platforms:
          - name: bios
            state: present
            partitionings:
              - nolvm-single
              - lvm-multi1
              - lvm-multi2
          - name: efi64
            state: present
            partitionings:
              - nolvm-single
              - lvm-multi1
              - lvm-multi2
      # - name: Fedora.38
      # - name: Fedora.39
      # - name: Debian.Buster
      # - name: Debian.Bullseye
      # - name: Debian.Bookworm
      - name: Gparted.Any
        state: present
        platforms:
          - name: bios
            state: present
          - name: efi64
            state: absent
      # - name: Clonezilla.Any


pxe_sysprep_specs_platforms:
  bios:
    state: present
    # pxe_tftp_addr: pxe.infra.ginhoux.net
    pxe_http_addr: http://pxe.infra.ginhoux.net
    sysprep_folder: "sysprep/bios"
    menu_folder: "menu/bios"
    menu_files:
      - default
      - default.entries
      - default.theme
      - splash.png
  efi64:
    state: present
    # pxe_tftp_addr: pxe.infra.ginhoux.net
    pxe_http_addr: http://pxe.infra.ginhoux.net
    sysprep_folder: "sysprep/efi64"
    menu_folder: "menu/efi64"
    menu_files:
      - default
      - default.entries
      - default.theme
      - splash.png


pxe_sysprep_specs_os_images:
  Clonezilla.Any:
    state: present
    type: tool
    label: Launch CloneZilla tools
    platforms:
      bios:
        state: present
        menu:
          kernel_opts: os/clonezilla.any/vmlinuz
          append_opts: initrd=os/clonezilla.any/initrd.img boot=live username=user union=overlay config components quiet noswap edd=on nomodeset nodmraid locales= keyboard-layouts= ocs_live_run="ocs-live-general" ocs_live_extra_param="" ocs_live_batch=no net.ifnames=0 nosplash noprompt fetch={{ pxe_sysprep_specs_platforms.bios.pxe_http_addr }}/os/clonezilla.any/filesystem.squashfs
      efi64:
        state: present
        menu:
          kernel_opts: os/clonezilla.any/vmlinuz
          append_opts: initrd=os/clonezilla.any/initrd.img boot=live username=user union=overlay config components quiet noswap edd=on nomodeset nodmraid locales= keyboard-layouts= ocs_live_run="ocs-live-general" ocs_live_extra_param="" ocs_live_batch=no net.ifnames=0 nosplash noprompt fetch={{ pxe_sysprep_specs_platforms.efi64.pxe_http_addr }}/os/clonezilla.any/filesystem.squashfs
  Gparted.Any:
    state: present
    type: tool
    label: Launch Gparted tools
    platforms:
      bios:
        state: present
        menu:
          kernel_opts: os/gparted.any/vmlinuz
          append_opts: initrd=os/gparted.any/initrd.img boot=live config components union=overlay username=user noswap noeject vga=791 fetch={{ pxe_sysprep_specs_platforms.efi64.pxe_http_addr }}/os/gparted.any/filesystem.squashfs
      efi64:
        state: present
        menu:
          kernel_opts: os/gparted.any/vmlinuz
          append_opts: initrd=os/gparted.any/initrd.img boot=live config components union=overlay username=user noswap noeject vga=791 fetch={{ pxe_sysprep_specs_platforms.efi64.pxe_http_addr }}/os/gparted.any/filesystem.squashfs
  Fedora.37:
    state: present
    type: sysprep
    label: Install Fedora 37
    mirror_url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/37/Server/x86_64/os/
    mirror_proxy: ""
    platforms:
      bios:
        state: present
        partitionings:
          nolvm-single:
            state: present
            scheme: |-
              part / --size 1 --grow --asprimary --fstype={_{_{_ server.filesystem _}_}_} --ondisk={_{_{_ server.disk _}_}_}
          lvm-multi1:
            state: present
            scheme: |-
              part /boot --fstype={_{_{_ server.filesystem_boot _}_}_} --size=512 --ondisk={_{_{_ server.disk _}_}_}
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk={_{_{_ server.disk _}_}_}
              volgroup {_{_{_ server.vgname _}_}_} --pesize=32768 pv.1
              logvol / --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=4096 --name=lv-root
              logvol /var --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-var
              logvol /home --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-home
              logvol /tmp --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-tmp
              logvol swap --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-swap
          lvm-multi2:
            state: present
            scheme: |-
              part /boot --fstype={_{_{_ server.filesystem_boot _}_}_} --size=512 --ondisk={_{_{_ server.disk _}_}_}
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk={_{_{_ server.disk _}_}_}
              volgroup {_{_{_ server.vgname _}_}_} --pesize=32768 pv.1
              logvol / --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-root
              logvol /usr --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=4096 --name=lv-usr
              logvol /var --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-var
              logvol /home --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-home
              logvol /tmp --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-tmp
              logvol /opt --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-opt
              logvol swap --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-swap
        menu:
          kernel_opts: os/Fedora.37/vmlinuz
          append_opts: initrd=os/Fedora.37/initrd.img utf8 text
          append_sysprep_server_opts: inst.ks=
      efi64:
        state: present
        partitionings:
          nolvm-single:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk={_{_{_ server.disk _}_}_}
              part / --size 1 --grow --asprimary --fstype={_{_{_ server.filesystem _}_}_} --ondisk={_{_{_ server.disk _}_}_}
          lvm-multi1:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk={_{_{_ server.disk _}_}_}
              part /boot --fstype={_{_{_ server.filesystem_boot _}_}_} --size=512 --ondisk={_{_{_ server.disk _}_}_}
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk={_{_{_ server.disk _}_}_}
              volgroup {_{_{_ server.vgname _}_}_} --pesize=32768 pv.1
              logvol / --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=4096 --name=lv-root
              logvol /var --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-var
              logvol /home --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-home
              logvol /tmp --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-tmp
              logvol swap --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-swap
          lvm-multi2:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk={_{_{_ server.disk _}_}_}
              part /boot --fstype={_{_{_ server.filesystem_boot _}_}_} --size=512 --ondisk={_{_{_ server.disk _}_}_}
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk={_{_{_ server.disk _}_}_}
              volgroup {_{_{_ server.vgname _}_}_} --pesize=32768 pv.1
              logvol / --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-root
              logvol /usr --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=4096 --name=lv-usr
              logvol /var --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-var
              logvol /home --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-home
              logvol /tmp --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-tmp
              logvol /opt --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-opt
              logvol swap --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-swap
        menu:
          kernel_opts: os/Fedora.37/vmlinuz
          append_opts: initrd=os/Fedora.37/initrd.img utf8 text
          append_sysprep_server_opts: inst.ks=
  Fedora.38:
    state: present
    type: sysprep
    label: Install Fedora 38
    mirror_url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/38/Server/x86_64/os/
    mirror_proxy: ""
    platforms:
      bios:
        state: present
        partitionings:
          nolvm-single:
            state: present
            scheme: |-
              part / --size 1 --grow --asprimary --fstype={_{_{_ server.filesystem _}_}_} --ondisk={_{_{_ server.disk _}_}_}
          lvm-multi1:
            state: present
            scheme: |-
              part /boot --fstype={_{_{_ server.filesystem_boot _}_}_} --size=512 --ondisk={_{_{_ server.disk _}_}_}
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk={_{_{_ server.disk _}_}_}
              volgroup {_{_{_ server.vgname _}_}_} --pesize=32768 pv.1
              logvol / --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=4096 --name=lv-root
              logvol /var --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-var
              logvol /home --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-home
              logvol /tmp --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-tmp
              logvol swap --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-swap
          lvm-multi2:
            state: present
            scheme: |-
              part /boot --fstype={_{_{_ server.filesystem_boot _}_}_} --size=512 --ondisk={_{_{_ server.disk _}_}_}
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk={_{_{_ server.disk _}_}_}
              volgroup {_{_{_ server.vgname _}_}_} --pesize=32768 pv.1
              logvol / --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-root
              logvol /usr --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=4096 --name=lv-usr
              logvol /var --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-var
              logvol /home --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-home
              logvol /tmp --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-tmp
              logvol /opt --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-opt
              logvol swap --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-swap
        menu:
          kernel_opts: os/Fedora.38/vmlinuz
          append_opts: initrd=os/Fedora.38/initrd.img utf8 text
          append_sysprep_server_opts: inst.ks=
      efi64:
        state: present
        partitionings:
          nolvm-single:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk={_{_{_ server.disk _}_}_}
              part / --size 1 --grow --asprimary --fstype={_{_{_ server.filesystem _}_}_} --ondisk={_{_{_ server.disk _}_}_}
          lvm-multi1:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk={_{_{_ server.disk _}_}_}
              part /boot --fstype={_{_{_ server.filesystem_boot _}_}_} --size=512 --ondisk={_{_{_ server.disk _}_}_}
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk={_{_{_ server.disk _}_}_}
              volgroup {_{_{_ server.vgname _}_}_} --pesize=32768 pv.1
              logvol / --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=4096 --name=lv-root
              logvol /var --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-var
              logvol /home --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-home
              logvol /tmp --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-tmp
              logvol swap --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-swap
          lvm-multi2:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk={_{_{_ server.disk _}_}_}
              part /boot --fstype={_{_{_ server.filesystem_boot _}_}_} --size=512 --ondisk={_{_{_ server.disk _}_}_}
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk={_{_{_ server.disk _}_}_}
              volgroup {_{_{_ server.vgname _}_}_} --pesize=32768 pv.1
              logvol / --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-root
              logvol /usr --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=4096 --name=lv-usr
              logvol /var --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-var
              logvol /home --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-home
              logvol /tmp --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-tmp
              logvol /opt --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-opt
              logvol swap --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-swap
        menu:
          kernel_opts: os/Fedora.38/vmlinuz
          append_opts: initrd=os/Fedora.38/initrd.img utf8 text
          append_sysprep_server_opts: inst.ks=
  Fedora.39:
    state: present
    type: sysprep
    label: Install Fedora 39
    mirror_url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/39/Server/x86_64/os/
    mirror_proxy: ""
    platforms:
      bios:
        state: present
        partitionings:
          nolvm-single:
            state: present
            scheme: |-
              part / --size 1 --grow --asprimary --fstype={_{_{_ server.filesystem _}_}_} --ondisk={_{_{_ server.disk _}_}_}
          lvm-multi1:
            state: present
            scheme: |-
              part /boot --fstype={_{_{_ server.filesystem_boot _}_}_} --size=512 --ondisk={_{_{_ server.disk _}_}_}
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk={_{_{_ server.disk _}_}_}
              volgroup {_{_{_ server.vgname _}_}_} --pesize=32768 pv.1
              logvol / --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=4096 --name=lv-root
              logvol /var --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-var
              logvol /home --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-home
              logvol /tmp --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-tmp
              logvol swap --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-swap
          lvm-multi2:
            state: present
            scheme: |-
              part /boot --fstype={_{_{_ server.filesystem_boot _}_}_} --size=512 --ondisk={_{_{_ server.disk _}_}_}
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk={_{_{_ server.disk _}_}_}
              volgroup {_{_{_ server.vgname _}_}_} --pesize=32768 pv.1
              logvol / --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-root
              logvol /usr --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=4096 --name=lv-usr
              logvol /var --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-var
              logvol /home --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-home
              logvol /tmp --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-tmp
              logvol /opt --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-opt
              logvol swap --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-swap
        menu:
          kernel_opts: os/Fedora.39/vmlinuz
          append_opts: initrd=os/Fedora.39/initrd.img utf8 text
          append_sysprep_server_opts: inst.ks=
      efi64:
        state: present
        partitionings:
          nolvm-single:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk={_{_{_ server.disk _}_}_}
              part / --size 1 --grow --asprimary --fstype={_{_{_ server.filesystem _}_}_} --ondisk={_{_{_ server.disk _}_}_}
          lvm-multi1:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk={_{_{_ server.disk _}_}_}
              part /boot --fstype={_{_{_ server.filesystem_boot _}_}_} --size=512 --ondisk={_{_{_ server.disk _}_}_}
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk={_{_{_ server.disk _}_}_}
              volgroup {_{_{_ server.vgname _}_}_} --pesize=32768 pv.1
              logvol / --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=4096 --name=lv-root
              logvol /var --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-var
              logvol /home --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-home
              logvol /tmp --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-tmp
              logvol swap --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-swap
          lvm-multi2:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk={_{_{_ server.disk _}_}_}
              part /boot --fstype={_{_{_ server.filesystem_boot _}_}_} --size=512 --ondisk={_{_{_ server.disk _}_}_}
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk={_{_{_ server.disk _}_}_}
              volgroup {_{_{_ server.vgname _}_}_} --pesize=32768 pv.1
              logvol / --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-root
              logvol /usr --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=4096 --name=lv-usr
              logvol /var --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-var
              logvol /home --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-home
              logvol /tmp --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-tmp
              logvol /opt --fstype {_{_{_ server.filesystem _}_}_} --vgname {_{_{_ server.vgname _}_}_} --size=1024 --name=lv-opt
              logvol swap --vgname {_{_{_ server.vgname _}_}_} --size=2048 --name=lv-swap
        menu:
          kernel_opts: os/Fedora.39/vmlinuz
          append_opts: initrd=os/Fedora.39/initrd.img utf8 text
          append_sysprep_server_opts: inst.ks=
  Debian.Buster:
    state: present
    type: sysprep
    label: Install Debian Buster
    mirror_url: ftp.fr.debian.org
    mirror_directory: /debian
    mirror_proxy: ""
    platforms:
      bios:
        state: present
        partitionings:
          nolvm-single:
            state: present
            scheme: |-
              d-i partman-auto/method string regular
              d-i partman-auto/expert_recipe string boot-root :: \
              6144 50 -1 {_{_{_ server.filesystem _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } .
          lvm-multi1:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string {_{_{_ server.vgname _}_}_}
              d-i partman-auto/expert_recipe string boot-root :: \
              512 512 512 {_{_{_ server.filesystem_boot _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem_boot _}_}_} } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ {_{_{_ server.vgname _}_}_} } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-root } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } . \
              2048 2048 2048 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-var } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /var } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-home } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /home } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-tmp } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /tmp } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ {_{_{_ server.vgname _}_}_} } method{ swap } format{ } .
          lvm-multi2:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string {_{_{_ server.vgname _}_}_}
              d-i partman-auto/expert_recipe string boot-root :: \
              512 512 512 {_{_{_ server.filesystem_boot _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem_boot _}_}_} } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ {_{_{_ server.vgname _}_}_} } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-root } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-usr } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /usr } . \
              2048 2048 2048 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-var } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /var } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-home } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /home } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-tmp } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /tmp } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-opt } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /opt } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ {_{_{_ server.vgname _}_}_} } method{ swap } format{ } .
        menu:
          kernel_opts: os/Debian.Buster/linux
          append_opts: initrd=os/Debian.Buster/initrd.gz vga=788 auto=true
      efi64:
        state: present
        partitionings:
          nolvm-single:
            state: present
            scheme: |-
              d-i partman-auto/method string regular
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              6144 50 -1 {_{_{_ server.filesystem _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } .
          lvm-multi1:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string {_{_{_ server.vgname _}_}_}
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              512 512 512 {_{_{_ server.filesystem_boot _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem_boot _}_}_} } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ {_{_{_ server.vgname _}_}_} } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-root } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } . \
              2048 2048 2048 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-var } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /var } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-home } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /home } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-tmp } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /tmp } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ {_{_{_ server.vgname _}_}_} } method{ swap } format{ } .
          lvm-multi2:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string {_{_{_ server.vgname _}_}_}
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              512 512 512 {_{_{_ server.filesystem_boot _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem_boot _}_}_} } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ {_{_{_ server.vgname _}_}_} } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-root } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-usr } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /usr } . \
              2048 2048 2048 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-var } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /var } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-home } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /home } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-tmp } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /tmp } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-opt } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /opt } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ {_{_{_ server.vgname _}_}_} } method{ swap } format{ } .
        menu:
          kernel_opts: os/Debian.Buster/linux
          append_opts: initrd=os/Debian.Buster/initrd.gz vga=788 auto=true
  Debian.Bullseye:
    state: present
    type: sysprep
    label: Install Debian Bullseye
    mirror_url: ftp.fr.debian.org
    mirror_directory: /debian
    mirror_proxy: ""
    platforms:
      bios:
        state: present
        partitionings:
          nolvm-single:
            state: present
            scheme: |-
              d-i partman-auto/method string regular
              d-i partman-auto/expert_recipe string boot-root :: \
              6144 50 -1 {_{_{_ server.filesystem _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } .
          lvm-multi1:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string {_{_{_ server.vgname _}_}_}
              d-i partman-auto/expert_recipe string boot-root :: \
              512 512 512 {_{_{_ server.filesystem_boot _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem_boot _}_}_} } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ {_{_{_ server.vgname _}_}_} } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-root } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } . \
              2048 2048 2048 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-var } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /var } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-home } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /home } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-tmp } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /tmp } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ {_{_{_ server.vgname _}_}_} } method{ swap } format{ } .
          lvm-multi2:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string {_{_{_ server.vgname _}_}_}
              d-i partman-auto/expert_recipe string boot-root :: \
              512 512 512 {_{_{_ server.filesystem_boot _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem_boot _}_}_} } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ {_{_{_ server.vgname _}_}_} } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-root } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-usr } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /usr } . \
              2048 2048 2048 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-var } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /var } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-home } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /home } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-tmp } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /tmp } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-opt } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /opt } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ {_{_{_ server.vgname _}_}_} } method{ swap } format{ } .
        menu:
          kernel_opts: os/Debian.Bullseye/linux
          append_opts: initrd=os/Debian.Bullseye/initrd.gz vga=788 auto=true
      efi64:
        state: present
        partitionings:
          nolvm-single:
            state: present
            scheme: |-
              d-i partman-auto/method string regular
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              6144 50 -1 {_{_{_ server.filesystem _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } .
          lvm-multi1:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string {_{_{_ server.vgname _}_}_}
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              512 512 512 {_{_{_ server.filesystem_boot _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem_boot _}_}_} } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ {_{_{_ server.vgname _}_}_} } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-root } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } . \
              2048 2048 2048 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-var } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /var } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-home } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /home } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-tmp } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /tmp } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ {_{_{_ server.vgname _}_}_} } method{ swap } format{ } .
          lvm-multi2:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string {_{_{_ server.vgname _}_}_}
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              512 512 512 {_{_{_ server.filesystem_boot _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem_boot _}_}_} } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ {_{_{_ server.vgname _}_}_} } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-root } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-usr } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /usr } . \
              2048 2048 2048 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-var } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /var } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-home } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /home } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-tmp } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /tmp } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-opt } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /opt } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ {_{_{_ server.vgname _}_}_} } method{ swap } format{ } .
        menu:
          kernel_opts: os/Debian.Bullseye/linux
          append_opts: initrd=os/Debian.Bullseye/initrd.gz vga=788 auto=true
  Debian.Bookworm:
    state: present
    type: sysprep
    label: Install Debian Bookworm
    mirror_url: ftp.fr.debian.org
    mirror_directory: /debian
    mirror_proxy: ""
    platforms:
      bios:
        state: present
        partitionings:
          nolvm-single:
            state: present
            scheme: |-
              d-i partman-auto/method string regular
              d-i partman-auto/expert_recipe string boot-root :: \
              6144 50 -1 {_{_{_ server.filesystem _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } .
          lvm-multi1:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string {_{_{_ server.vgname _}_}_}
              d-i partman-auto/expert_recipe string boot-root :: \
              512 512 512 {_{_{_ server.filesystem_boot _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem_boot _}_}_} } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ {_{_{_ server.vgname _}_}_} } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-root } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } . \
              2048 2048 2048 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-var } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /var } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-home } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /home } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-tmp } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /tmp } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ {_{_{_ server.vgname _}_}_} } method{ swap } format{ } .
          lvm-multi2:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string {_{_{_ server.vgname _}_}_}
              d-i partman-auto/expert_recipe string boot-root :: \
              512 512 512 {_{_{_ server.filesystem_boot _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem_boot _}_}_} } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ {_{_{_ server.vgname _}_}_} } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-root } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-usr } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /usr } . \
              2048 2048 2048 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-var } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /var } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-home } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /home } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-tmp } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /tmp } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-opt } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /opt } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ {_{_{_ server.vgname _}_}_} } method{ swap } format{ } .
        menu:
          kernel_opts: os/Debian.Bookworm/linux
          append_opts: initrd=os/Debian.Bookworm/initrd.gz vga=788 auto=true
      efi64:
        state: present
        partitionings:
          nolvm-single:
            state: present
            scheme: |-
              d-i partman-auto/method string regular
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              6144 50 -1 {_{_{_ server.filesystem _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } .
          lvm-multi1:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string {_{_{_ server.vgname _}_}_}
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              512 512 512 {_{_{_ server.filesystem_boot _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem_boot _}_}_} } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ {_{_{_ server.vgname _}_}_} } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-root } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } . \
              2048 2048 2048 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-var } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /var } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-home } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /home } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-tmp } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /tmp } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ {_{_{_ server.vgname _}_}_} } method{ swap } format{ } .
          lvm-multi2:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string {_{_{_ server.vgname _}_}_}
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              512 512 512 {_{_{_ server.filesystem_boot _}_}_} $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem_boot _}_}_} } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ {_{_{_ server.vgname _}_}_} } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-root } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ / } . \
              4096 4096 4096 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-usr } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /usr } . \
              2048 2048 2048 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-var } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /var } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-home } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /home } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-tmp } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /tmp } . \
              1024 1024 1024 {_{_{_ server.filesystem _}_}_} $lvmok{ } $lv_name{ lv-opt } in_vg{ {_{_{_ server.vgname _}_}_} } method{ format } format{ } use_filesystem{ } filesystem{ {_{_{_ server.filesystem _}_}_} } mountpoint{ /opt } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ {_{_{_ server.vgname _}_}_} } method{ swap } format{ } .
        menu:
          kernel_opts: os/Debian.Bookworm/linux
          append_opts: initrd=os/Debian.Bookworm/initrd.gz vga=788 auto=true









pxe_deploy_configure_action: generate
# pxe_deploy_configure_action: cleanup

pxe_deploy_menu_folder: /srv/tftp/menu
pxe_deploy_sysprep_folder: /srv/tftp/sysprep
pxe_deploy_tftp_address: pxe.infra.ginhoux.net

pxe_deploy_menu_default_files_bios:
  - default
  - default.entries
  - default.theme
  - splash.png
pxe_deploy_menu_default_files_efi64:
  - default
  - default.entries
  - default.theme
  - splash.png

# pxe_deploy_cleanup: false

pxe_deploy:
  - name: srv-swarm-manager1.infra.ginhoux.net
    os: Fedora.37
    partitionning: nolvm-single
    filesystem: ext4
    filesystem_boot: ext2
    vgname: vg0
    disk: sda
    domain: infra.ginhoux.net
    rootpwd: root
    locale: en_US.UTF-8
    kblayout: fr
    timezone: Europe/Paris


pxe_deploy_debian_stretch_mirror_hostname: ftp.fr.debian.org
pxe_deploy_debian_stretch_mirror_directory: /debian
pxe_deploy_debian_stretch_mirror_proxy: ""

pxe_deploy_debian_buster_mirror_hostname: ftp.fr.debian.org
pxe_deploy_debian_buster_mirror_directory: /debian
pxe_deploy_debian_buster_mirror_proxy: ""

pxe_deploy_debian_bullseye_mirror_hostname: ftp.fr.debian.org
pxe_deploy_debian_bullseye_mirror_directory: /debian
pxe_deploy_debian_bullseye_mirror_proxy: ""

pxe_deploy_debian_bookworm_mirror_hostname: ftp.fr.debian.org
pxe_deploy_debian_bookworm_mirror_directory: /debian
pxe_deploy_debian_bookworm_mirror_proxy: ""

pxe_deploy_centos_7_mirror_url: http://mirror.centos.org/centos-7/7/os/x86_64/
pxe_deploy_centos_8_mirror_url: http://mirror.centos.org/centos-8/8/BaseOS/x86_64/os/

pxe_deploy_fedora_32_mirror_url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/32/Server/x86_64/os/
pxe_deploy_fedora_33_mirror_url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/33/Server/x86_64/os/
pxe_deploy_fedora_34_mirror_url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/34/Server/x86_64/os/
pxe_deploy_fedora_35_mirror_url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/35/Server/x86_64/os/
pxe_deploy_fedora_36_mirror_url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/36/Server/x86_64/os/
pxe_deploy_fedora_37_mirror_url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/37/Server/x86_64/os/
pxe_deploy_fedora_38_mirror_url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/38/Server/x86_64/os/
pxe_deploy_fedora_39_mirror_url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/39/Server/x86_64/os/
