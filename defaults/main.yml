---

pxe_sysprep_configure_action: generate
# pxe_sysprep_configure_action: cleanup

pxe_sysprep_root_folder: /srv/tftp


pxe_sysprep_generate_servers_list:
  - name: srv-swarm-manager1.infra.ginhoux.net
    state: present
    filesystem_global: ext4
    filesystem_boot: ext2
    vgname: vg0
    disk: sda
    domain: infra.ginhoux.net
    rootpwd: ROOTroot1234
    locale: en_US.UTF-8
    kblayout: fr
    timezone: Europe/Paris
    os_images_list:
      - name: fedora.37.x86_64
        state: present
        platforms:
          - { name: bios, state: present, partitionings: { "atomic", "lvm1", "lvm2" } }
          - { name: efi64, state: present, partitionings: { "atomic", "lvm1", "lvm2" } }
      - name: fedora.38.x86_64
        state: present
        platforms:
          - { name: bios, state: present, partitionings: { "atomic", "lvm1", "lvm2" } }
          - { name: efi64, state: present, partitionings: { "atomic", "lvm1", "lvm2" } }
      - name: fedora.39.x86_64
        state: present
        platforms:
          - { name: bios, state: present, partitionings: { "atomic", "lvm1", "lvm2" } }
          - { name: efi64, state: present, partitionings: { "atomic", "lvm1", "lvm2" } }
      - name: debian.buster.x86_64
        state: present
        platforms:
          - { name: bios, state: present, partitionings: { "atomic", "lvm1", "lvm2" } }
          - { name: efi64, state: present, partitionings: { "atomic", "lvm1", "lvm2" } }
      - name: debian.bookworm.x86_64
        state: present
        platforms:
          - { name: bios, state: present, partitionings: { "atomic", "lvm1", "lvm2" } }
          - { name: efi64, state: present, partitionings: { "atomic", "lvm1", "lvm2" } }
      - name: debian.bullseye.x86_64
        state: present
        platforms:
          - { name: bios, state: present, partitionings: { "atomic", "lvm1", "lvm2" } }
          - { name: efi64, state: present, partitionings: { "atomic", "lvm1", "lvm2" } }
      - name: clonezilla.any.x86_64
        state: present
        platforms:
          - { name: bios, state: present }
          - { name: efi64, state: present }
      - name: gparted.any.x86_64
        state: present
        platforms:
          - { name: bios, state: present }
          - { name: efi64, state: present }

pxe_sysprep_specs_platforms:
  bios:
    state: present
    # pxe_tftp_addr: pxe.infra.ginhoux.net
    pxe_http_addr: http://pxe.infra.ginhoux.net
    sysprep_folder: "sysprep/bios"
    menu_folder: "menu/bios"
    menu_files: { "default", "default.entries", "default.theme", "splash.png" }
  efi64:
    state: present
    # pxe_tftp_addr: pxe.infra.ginhoux.net
    pxe_http_addr: http://pxe.infra.ginhoux.net
    sysprep_folder: "sysprep/efi64"
    menu_folder: "menu/efi64"
    menu_files: { "default", "default.entries", "default.theme", "splash.png" }


pxe_sysprep_specs_os_images:
  clonezilla.any.x86_64:
    state: present
    type: tool
    label: launch clonezilla tools
    platforms:
      bios:
        state: present
        menu:
          kernel_opts: os/clonezilla.any.x86_64/vmlinuz
          append_opts: >-
            initrd=os/clonezilla.any.x86_64/initrd.img boot=live username=user
            union=overlay config components quiet noswap edd=on nomodeset
            nodmraid locales= keyboard-layouts= ocs_live_run="ocs-live-general"
            ocs_live_extra_param="" ocs_live_batch=no net.ifnames=0 nosplash noprompt
            fetch=VAR_PXE_HTTP_URL/os/clonezilla.any.x86_64/filesystem.squashfs
      efi64:
        state: present
        menu:
          kernel_opts: os/clonezilla.any.x86_64/vmlinuz
          append_opts: >-
            initrd=os/clonezilla.any.x86_64/initrd.img boot=live username=user
            union=overlay config components quiet noswap edd=on nomodeset
            nodmraid locales= keyboard-layouts= ocs_live_run="ocs-live-general"
            ocs_live_extra_param="" ocs_live_batch=no net.ifnames=0 nosplash noprompt
            fetch=VAR_PXE_HTTP_URL/os/clonezilla.any.x86_64/filesystem.squashfs
  gparted.any.x86_64:
    state: present
    type: tool
    label: launch gparted tools
    platforms:
      bios:
        state: present
        menu:
          kernel_opts: os/gparted.any.x86_64/vmlinuz
          append_opts: >-
            initrd=os/gparted.any.x86_64/initrd.img boot=live config components union=overlay
            username=user noswap noeject vga=791
            fetch=VAR_PXE_HTTP_URL/os/gparted.any.x86_64/filesystem.squashfs
      efi64:
        state: present
        menu:
          kernel_opts: os/gparted.any.x86_64/vmlinuz
          append_opts: >-
            initrd=os/gparted.any.x86_64/initrd.img boot=live config components union=overlay
            username=user noswap noeject vga=791
            fetch=VAR_PXE_HTTP_URL/os/gparted.any.x86_64/filesystem.squashfs
  fedora.37.x86_64:
    state: present
    type: sysprep
    label: install fedora 37 x86_64
    platforms:
      bios:
        state: present
        mirror:
          url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/37/Server/x86_64/os/
          # proxy: ""
        partitionings:
          atomic:
            state: present
            scheme: |-
              part / --size 1 --grow --asprimary --fstype=VAR_SERVER_FS_GLOBAL --ondisk=VAR_SERVER_DISK
          lvm1:
            state: present
            scheme: |-
              part /boot --fstype=VAR_SERVER_FS_BOOT --size=512 --ondisk=VAR_SERVER_DISK
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk=VAR_SERVER_DISK
              volgroup VAR_SERVER_VGNAME --pesize=32768 pv.1
              logvol / --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=4096 --name=lv-root
              logvol /var --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-var
              logvol /home --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-home
              logvol /tmp --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-tmp
              logvol swap --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-swap
          lvm2:
            state: present
            scheme: |-
              part /boot --fstype=VAR_SERVER_FS_BOOT --size=512 --ondisk=VAR_SERVER_DISK
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk=VAR_SERVER_DISK
              volgroup VAR_SERVER_VGNAME --pesize=32768 pv.1
              logvol / --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-root
              logvol /usr --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=4096 --name=lv-usr
              logvol /var --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-var
              logvol /home --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-home
              logvol /tmp --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-tmp
              logvol /opt --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-opt
              logvol swap --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-swap
        menu:
          kernel_opts: os/fedora.37.x86_64/vmlinuz
          append_opts: initrd=os/fedora.37.x86_64/initrd.img utf8 text
          append_sysprep_server_opts: inst.ks=VAR_SERVER_SYSPREP_FILE
      efi64:
        state: present
        mirror:
          url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/37/Server/x86_64/os/
          # proxy: ""
        partitionings:
          atomic:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk=VAR_SERVER_DISK
              part / --size 1 --grow --asprimary --fstype=VAR_SERVER_FS_GLOBAL --ondisk=VAR_SERVER_DISK
          lvm1:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk=VAR_SERVER_DISK
              part /boot --fstype=VAR_SERVER_FS_BOOT --size=512 --ondisk=VAR_SERVER_DISK
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk=VAR_SERVER_DISK
              volgroup VAR_SERVER_VGNAME --pesize=32768 pv.1
              logvol / --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=4096 --name=lv-root
              logvol /var --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-var
              logvol /home --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-home
              logvol /tmp --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-tmp
              logvol swap --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-swap
          lvm2:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk=VAR_SERVER_DISK
              part /boot --fstype=VAR_SERVER_FS_BOOT --size=512 --ondisk=VAR_SERVER_DISK
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk=VAR_SERVER_DISK
              volgroup VAR_SERVER_VGNAME --pesize=32768 pv.1
              logvol / --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-root
              logvol /usr --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=4096 --name=lv-usr
              logvol /var --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-var
              logvol /home --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-home
              logvol /tmp --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-tmp
              logvol /opt --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-opt
              logvol swap --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-swap
        menu:
          kernel_opts: os/fedora.37.x86_64/vmlinuz
          append_opts: initrd=os/fedora.37.x86_64/initrd.img utf8 text
          append_sysprep_server_opts: inst.ks=VAR_SERVER_SYSPREP_FILE
  fedora.38.x86_64:
    state: present
    type: sysprep
    label: install fedora 38 x86_64
    platforms:
      bios:
        state: present
        mirror:
          url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/37/Server/x86_64/os/
          # proxy: ""
        partitionings:
          atomic:
            state: present
            scheme: |-
              part / --size 1 --grow --asprimary --fstype=VAR_SERVER_FS_GLOBAL --ondisk=VAR_SERVER_DISK
          lvm1:
            state: present
            scheme: |-
              part /boot --fstype=VAR_SERVER_FS_BOOT --size=512 --ondisk=VAR_SERVER_DISK
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk=VAR_SERVER_DISK
              volgroup VAR_SERVER_VGNAME --pesize=32768 pv.1
              logvol / --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=4096 --name=lv-root
              logvol /var --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-var
              logvol /home --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-home
              logvol /tmp --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-tmp
              logvol swap --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-swap
          lvm2:
            state: present
            scheme: |-
              part /boot --fstype=VAR_SERVER_FS_BOOT --size=512 --ondisk=VAR_SERVER_DISK
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk=VAR_SERVER_DISK
              volgroup VAR_SERVER_VGNAME --pesize=32768 pv.1
              logvol / --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-root
              logvol /usr --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=4096 --name=lv-usr
              logvol /var --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-var
              logvol /home --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-home
              logvol /tmp --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-tmp
              logvol /opt --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-opt
              logvol swap --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-swap
        menu:
          kernel_opts: os/fedora.38.x86_64/vmlinuz
          append_opts: initrd=os/fedora.38.x86_64/initrd.img utf8 text
          append_sysprep_server_opts: inst.ks=VAR_SERVER_SYSPREP_FILE
      efi64:
        state: present
        mirror:
          url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/37/Server/x86_64/os/
          # proxy: ""
        partitionings:
          atomic:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk=VAR_SERVER_DISK
              part / --size 1 --grow --asprimary --fstype=VAR_SERVER_FS_GLOBAL --ondisk=VAR_SERVER_DISK
          lvm1:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk=VAR_SERVER_DISK
              part /boot --fstype=VAR_SERVER_FS_BOOT --size=512 --ondisk=VAR_SERVER_DISK
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk=VAR_SERVER_DISK
              volgroup VAR_SERVER_VGNAME --pesize=32768 pv.1
              logvol / --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=4096 --name=lv-root
              logvol /var --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-var
              logvol /home --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-home
              logvol /tmp --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-tmp
              logvol swap --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-swap
          lvm2:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk=VAR_SERVER_DISK
              part /boot --fstype=VAR_SERVER_FS_BOOT --size=512 --ondisk=VAR_SERVER_DISK
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk=VAR_SERVER_DISK
              volgroup VAR_SERVER_VGNAME --pesize=32768 pv.1
              logvol / --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-root
              logvol /usr --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=4096 --name=lv-usr
              logvol /var --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-var
              logvol /home --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-home
              logvol /tmp --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-tmp
              logvol /opt --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-opt
              logvol swap --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-swap
        menu:
          kernel_opts: os/fedora.38.x86_64/vmlinuz
          append_opts: initrd=os/fedora.38.x86_64/initrd.img utf8 text
          append_sysprep_server_opts: inst.ks=VAR_SERVER_SYSPREP_FILE
  fedora.39.x86_64:
    state: present
    type: sysprep
    label: install fedora 39 x86_64
    platforms:
      bios:
        state: present
        mirror:
          url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/37/Server/x86_64/os/
          # proxy: ""
        partitionings:
          atomic:
            state: present
            scheme: |-
              part / --size 1 --grow --asprimary --fstype=VAR_SERVER_FS_GLOBAL --ondisk=VAR_SERVER_DISK
          lvm1:
            state: present
            scheme: |-
              part /boot --fstype=VAR_SERVER_FS_BOOT --size=512 --ondisk=VAR_SERVER_DISK
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk=VAR_SERVER_DISK
              volgroup VAR_SERVER_VGNAME --pesize=32768 pv.1
              logvol / --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=4096 --name=lv-root
              logvol /var --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-var
              logvol /home --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-home
              logvol /tmp --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-tmp
              logvol swap --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-swap
          lvm2:
            state: present
            scheme: |-
              part /boot --fstype=VAR_SERVER_FS_BOOT --size=512 --ondisk=VAR_SERVER_DISK
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk=VAR_SERVER_DISK
              volgroup VAR_SERVER_VGNAME --pesize=32768 pv.1
              logvol / --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-root
              logvol /usr --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=4096 --name=lv-usr
              logvol /var --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-var
              logvol /home --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-home
              logvol /tmp --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-tmp
              logvol /opt --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-opt
              logvol swap --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-swap
        menu:
          kernel_opts: os/fedora.39.x86_64/vmlinuz
          append_opts: initrd=os/fedora.39.x86_64/initrd.img utf8 text
          append_sysprep_server_opts: inst.ks=VAR_SERVER_SYSPREP_FILE
      efi64:
        state: present
        mirror:
          url: https://ftp.lip6.fr/ftp/pub/linux/distributions/fedora/releases/37/Server/x86_64/os/
          # proxy: ""
        partitionings:
          atomic:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk=VAR_SERVER_DISK
              part / --size 1 --grow --asprimary --fstype=VAR_SERVER_FS_GLOBAL --ondisk=VAR_SERVER_DISK
          lvm1:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk=VAR_SERVER_DISK
              part /boot --fstype=VAR_SERVER_FS_BOOT --size=512 --ondisk=VAR_SERVER_DISK
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk=VAR_SERVER_DISK
              volgroup VAR_SERVER_VGNAME --pesize=32768 pv.1
              logvol / --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=4096 --name=lv-root
              logvol /var --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-var
              logvol /home --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-home
              logvol /tmp --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-tmp
              logvol swap --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-swap
          lvm2:
            state: present
            scheme: |-
              part /boot/efi --size 128 --asprimary --fstype=efi --fsoptions="umask=0777,shortname=winnt" --ondisk=VAR_SERVER_DISK
              part /boot --fstype=VAR_SERVER_FS_BOOT --size=512 --ondisk=VAR_SERVER_DISK
              part pv.1 --size 1 --grow --fstype=lvmpv --ondisk=VAR_SERVER_DISK
              volgroup VAR_SERVER_VGNAME --pesize=32768 pv.1
              logvol / --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-root
              logvol /usr --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=4096 --name=lv-usr
              logvol /var --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-var
              logvol /home --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-home
              logvol /tmp --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-tmp
              logvol /opt --fstype VAR_SERVER_FS_GLOBAL --vgname VAR_SERVER_VGNAME --size=1024 --name=lv-opt
              logvol swap --vgname VAR_SERVER_VGNAME --size=2048 --name=lv-swap
        menu:
          kernel_opts: os/fedora.39.x86_64/vmlinuz
          append_opts: initrd=os/fedora.39.x86_64/initrd.img utf8 text
          append_sysprep_server_opts: inst.ks=VAR_SERVER_SYSPREP_FILE
  debian.buster.x86_64:
    state: present
    type: sysprep
    label: install debian buster
    platforms:
      bios:
        state: present
        mirror:
          url: http://ftp.fr.debian.org
          directory: /debian
          proxy: ""
        partitionings:
          atomic:
            state: present
            scheme: |-
              d-i partman-auto/method string regular
              d-i partman-auto/expert_recipe string boot-root :: \
              6144 50 -1 VAR_SERVER_FS_GLOBAL $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } .
          lvm1:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string VAR_SERVER_VGNAME
              d-i partman-auto/expert_recipe string boot-root :: \
              512 512 512 VAR_SERVER_FS_BOOT $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_BOOT } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ VAR_SERVER_VGNAME } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-root } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } . \
              2048 2048 2048 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-var } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /var } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-home } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /home } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-tmp } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /tmp } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ VAR_SERVER_VGNAME } method{ swap } format{ } .
          lvm2:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string VAR_SERVER_VGNAME
              d-i partman-auto/expert_recipe string boot-root :: \
              512 512 512 VAR_SERVER_FS_BOOT $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_BOOT } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ VAR_SERVER_VGNAME } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-root } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-usr } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /usr } . \
              2048 2048 2048 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-var } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /var } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-home } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /home } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-tmp } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /tmp } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-opt } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /opt } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ VAR_SERVER_VGNAME } method{ swap } format{ } .
        menu:
          kernel_opts: os/debian.buster.x86_64/linux
          append_opts: initrd=os/debian.buster.x86_64/initrd.gz vga=788 auto=true
          append_sysprep_server_opts: hostname=VAR_SERVER_NAME domain=VAR_SERVER_DOMAIN url=VAR_SERVER_SYSPREP_FILE
      efi64:
        state: present
        mirror:
          url: http://ftp.fr.debian.org
          directory: /debian
          proxy: ""
        partitionings:
          atomic:
            state: present
            scheme: |-
              d-i partman-auto/method string regular
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              6144 50 -1 VAR_SERVER_FS_GLOBAL $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } .
          lvm1:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string VAR_SERVER_VGNAME
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              512 512 512 VAR_SERVER_FS_BOOT $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_BOOT } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ VAR_SERVER_VGNAME } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-root } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } . \
              2048 2048 2048 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-var } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /var } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-home } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /home } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-tmp } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /tmp } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ VAR_SERVER_VGNAME } method{ swap } format{ } .
          lvm2:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string VAR_SERVER_VGNAME
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              512 512 512 VAR_SERVER_FS_BOOT $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_BOOT } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ VAR_SERVER_VGNAME } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-root } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-usr } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /usr } . \
              2048 2048 2048 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-var } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /var } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-home } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /home } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-tmp } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /tmp } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-opt } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /opt } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ VAR_SERVER_VGNAME } method{ swap } format{ } .
        menu:
          kernel_opts: os/debian.buster.x86_64/linux
          append_opts: initrd=os/debian.buster.x86_64/initrd.gz vga=788 auto=true
          append_sysprep_server_opts: hostname=VAR_SERVER_NAME domain=VAR_SERVER_DOMAIN url=VAR_SERVER_SYSPREP_FILE
  debian.bullseye.x86_64:
    state: present
    type: sysprep
    label: install debian bullseye
    platforms:
      bios:
        state: present
        mirror:
          url: http://ftp.fr.debian.org
          directory: /debian
          proxy: ""
        partitionings:
          atomic:
            state: present
            scheme: |-
              d-i partman-auto/method string regular
              d-i partman-auto/expert_recipe string boot-root :: \
              6144 50 -1 VAR_SERVER_FS_GLOBAL $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } .
          lvm1:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string VAR_SERVER_VGNAME
              d-i partman-auto/expert_recipe string boot-root :: \
              512 512 512 VAR_SERVER_FS_BOOT $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_BOOT } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ VAR_SERVER_VGNAME } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-root } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } . \
              2048 2048 2048 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-var } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /var } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-home } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /home } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-tmp } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /tmp } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ VAR_SERVER_VGNAME } method{ swap } format{ } .
          lvm2:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string VAR_SERVER_VGNAME
              d-i partman-auto/expert_recipe string boot-root :: \
              512 512 512 VAR_SERVER_FS_BOOT $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_BOOT } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ VAR_SERVER_VGNAME } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-root } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-usr } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /usr } . \
              2048 2048 2048 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-var } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /var } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-home } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /home } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-tmp } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /tmp } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-opt } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /opt } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ VAR_SERVER_VGNAME } method{ swap } format{ } .
        menu:
          kernel_opts: os/debian.bullseye.x86_64/linux
          append_opts: initrd=os/debian.bullseye.x86_64/initrd.gz vga=788 auto=true
          append_sysprep_server_opts: hostname=VAR_SERVER_NAME domain=VAR_SERVER_DOMAIN url=VAR_SERVER_SYSPREP_FILE
      efi64:
        state: present
        mirror:
          url: http://ftp.fr.debian.org
          directory: /debian
          proxy: ""
        partitionings:
          atomic:
            state: present
            scheme: |-
              d-i partman-auto/method string regular
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              6144 50 -1 VAR_SERVER_FS_GLOBAL $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } .
          lvm1:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string VAR_SERVER_VGNAME
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              512 512 512 VAR_SERVER_FS_BOOT $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_BOOT } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ VAR_SERVER_VGNAME } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-root } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } . \
              2048 2048 2048 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-var } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /var } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-home } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /home } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-tmp } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /tmp } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ VAR_SERVER_VGNAME } method{ swap } format{ } .
          lvm2:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string VAR_SERVER_VGNAME
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              512 512 512 VAR_SERVER_FS_BOOT $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_BOOT } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ VAR_SERVER_VGNAME } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-root } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-usr } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /usr } . \
              2048 2048 2048 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-var } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /var } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-home } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /home } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-tmp } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /tmp } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-opt } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /opt } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ VAR_SERVER_VGNAME } method{ swap } format{ } .
        menu:
          kernel_opts: os/debian.bullseye.x86_64/linux
          append_opts: initrd=os/debian.bullseye.x86_64/initrd.gz vga=788 auto=true
          append_sysprep_server_opts: hostname=VAR_SERVER_NAME domain=VAR_SERVER_DOMAIN url=VAR_SERVER_SYSPREP_FILE
  debian.bookworm.x86_64:
    state: present
    type: sysprep
    label: install debian bookworm
    platforms:
      bios:
        state: present
        mirror:
          url: http://ftp.fr.debian.org
          directory: /debian
          proxy: ""
        partitionings:
          atomic:
            state: present
            scheme: |-
              d-i partman-auto/method string regular
              d-i partman-auto/expert_recipe string boot-root :: \
              6144 50 -1 VAR_SERVER_FS_GLOBAL $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } .
          lvm1:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string VAR_SERVER_VGNAME
              d-i partman-auto/expert_recipe string boot-root :: \
              512 512 512 VAR_SERVER_FS_BOOT $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_BOOT } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ VAR_SERVER_VGNAME } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-root } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } . \
              2048 2048 2048 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-var } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /var } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-home } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /home } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-tmp } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /tmp } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ VAR_SERVER_VGNAME } method{ swap } format{ } .
          lvm2:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string VAR_SERVER_VGNAME
              d-i partman-auto/expert_recipe string boot-root :: \
              512 512 512 VAR_SERVER_FS_BOOT $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_BOOT } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ VAR_SERVER_VGNAME } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-root } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-usr } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /usr } . \
              2048 2048 2048 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-var } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /var } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-home } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /home } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-tmp } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /tmp } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-opt } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /opt } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ VAR_SERVER_VGNAME } method{ swap } format{ } .
        menu:
          kernel_opts: os/debian.bookworm.x86_64/linux
          append_opts: initrd=os/debian.bookworm.x86_64/initrd.gz vga=788 auto=true
          append_sysprep_server_opts: hostname=VAR_SERVER_NAME domain=VAR_SERVER_DOMAIN url=VAR_SERVER_SYSPREP_FILE
      efi64:
        state: present
        mirror:
          url: http://ftp.fr.debian.org
          directory: /debian
          proxy: ""
        partitionings:
          atomic:
            state: present
            scheme: |-
              d-i partman-auto/method string regular
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              6144 50 -1 VAR_SERVER_FS_GLOBAL $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } .
          lvm1:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string VAR_SERVER_VGNAME
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              512 512 512 VAR_SERVER_FS_BOOT $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_BOOT } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ VAR_SERVER_VGNAME } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-root } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } . \
              2048 2048 2048 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-var } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /var } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-home } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /home } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-tmp } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /tmp } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ VAR_SERVER_VGNAME } method{ swap } format{ } .
          lvm2:
            state: present
            scheme: |-
              d-i partman-auto/method string lvm
              d-i partman-auto-lvm/guided_size string 100%
              d-i partman-auto-lvm/new_vg_name string VAR_SERVER_VGNAME
              d-i partman-auto/expert_recipe string boot-root :: \
              128 128 128 free $primary{ } $iflabel{ gpt } $reusemethod{ } method{ efi } format{ } . \
              512 512 512 VAR_SERVER_FS_BOOT $primary{ } $bootable{ } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_BOOT } mountpoint{ /boot } . \
              6144 6144 6144 lvm $primary{ } method{ lvm } vg_name{ VAR_SERVER_VGNAME } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-root } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ / } . \
              4096 4096 4096 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-usr } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /usr } . \
              2048 2048 2048 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-var } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /var } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-home } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /home } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-tmp } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /tmp } . \
              1024 1024 1024 VAR_SERVER_FS_GLOBAL $lvmok{ } $lv_name{ lv-opt } in_vg{ VAR_SERVER_VGNAME } method{ format } format{ } use_filesystem{ } filesystem{ VAR_SERVER_FS_GLOBAL } mountpoint{ /opt } . \
              2048 2048 2048 linux-swap $lvmok{ } $lv_name{ lv-swap } in_vg{ VAR_SERVER_VGNAME } method{ swap } format{ } .
        menu:
          kernel_opts: os/debian.bookworm.x86_64/linux
          append_opts: initrd=os/debian.bookworm.x86_64/initrd.gz vga=788 auto=true
          append_sysprep_server_opts: hostname=VAR_SERVER_NAME domain=VAR_SERVER_DOMAIN url=VAR_SERVER_SYSPREP_FILE
